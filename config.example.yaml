# Dead Drop Server Configuration

# Server settings
server:
  # Address to listen on
  listen: ":8080"

  # Storage directory for encrypted drops
  storage_dir: "./drops"

  # Maximum upload size in MB
  max_upload_mb: 100

  # TLS configuration (optional, empty = plain HTTP)
  # tls:
  #   cert_file: "/path/to/cert.pem"
  #   key_file: "/path/to/key.pem"

# Security settings
security:
  # Delete files immediately after retrieval (true dead drop behavior)
  delete_after_retrieve: false

  # Maximum file age in hours before automatic cleanup (0 = disabled)
  # Default: 168 hours (7 days)
  max_age_hours: 168

  # Strip metadata from uploaded files on server-side (deprecated: prefer client-side)
  # Note: For true anonymity, use client-side scrubbing via CLI tool
  scrub_metadata: false

  # Rate limit: maximum requests per minute per IP (prevents DoS and enumeration)
  # Default: 10 requests per minute
  rate_limit_per_min: 10

  # Secure file deletion: overwrite files before removing (3-pass: zeros, ones, random)
  # Default: true
  secure_delete: true

  # Maximum total storage in GB (0 = unlimited)
  max_storage_gb: 0

  # Maximum number of drops stored at once (0 = unlimited)
  max_drops: 0

  # Master key encryption: name of environment variable containing the passphrase
  # When set, .encryption.key and .receipt.key are encrypted at rest using a key
  # derived from the passphrase via Argon2id. Empty = keys stored as plaintext.
  # Example: master_key_env: "DEAD_DROP_MASTER_KEY"
  # master_key_env: ""

  # Honeypot/canary drops: auto-generated decoy drops that trigger alerts on access
  # honeypots_enabled: true
  # honeypot_count: 5
  # alert_webhook: "https://your-webhook-endpoint.example.com/alert"

# Logging settings
logging:
  # Enable startup/configuration logging
  startup: true

  # Log errors (recommended)
  errors: true

  # Log file operations (DISABLE for anonymity in production)
  operations: false

  # Directory for log output (empty = stderr)
  # Point this to a tmpfs mount for ephemeral logs that don't survive reboots
  # Example: /var/log/dead-drop (mount as tmpfs)
  # log_dir: "/var/log/dead-drop"
